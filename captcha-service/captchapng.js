/**
 * captchapng
 * Captcha PNG generator
 * @Author: George Chan
 * @Email: gchan@21cn.com
 * @Version: 0.0.1
 * @Date: 2013-08-18
 * @license http://www.opensource.org/licenses/bsd-license.php BSD License
 */

var pnglib = require('pnglib');
this.numMask = [];
this.numMask[0]=[];
this.numMask[0]=loadNumMask0();
this.numMask[1]=loadNumMask1();
myself = this;

function loadNumMask0() {
    var numbmp=[];
    numbmp[0]=["0011111000","0111111110","0111111110","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","1110001111","0111111111"," 111111110","0011111100"];
    numbmp[1]=["0000011","0000111","0011111","1111111","1111111","0001111","0001111","0001111","0001111","0001111","0001111","0001111","0001111","0001111","0001111","0001111","0001111","0001111","0001111"];
    numbmp[2]=["001111100","011111110","111111111","111001111","111001111","111001111","111001111","000011111","000011110","000111110","000111100","000111100","001111000","001111000","011110000","011110000","111111111","111111111","111111111"];
    numbmp[3]=["0011111100","0111111110","1111111111","1111001111","1111001111","1111001111","0000001111","0001111110","0001111100","0001111111","0000001111","1111001111","1111001111","1111001111","1111001111","1111001111","1111111111","0111111110","0011111100"];
    numbmp[4]=["00001111110","00001111110","00011111110","00011111110","00011111110","00111011110","00111011110","00111011110","01110011110","01110011110","01110011110","11100011110","11111111111","11111111111","11111111111","11111111111","00000011110","00000011110","00000011110"];
    numbmp[5]=["1111111111","1111111111","1111111111","1111000000","1111000000","1111011100","1111111110","1111111111","1111001111","1111001111","0000001111","0000001111","1111001111","1111001111","1111001111","1111001111","1111111111","0111111110","0011111100"];
    numbmp[6]=["0011111100","0111111110","0111111111","1111001111","1111001111","1111000000","1111011100","1111111110","1111111111","1111001111","1111001111","1111001111","1111001111","1111001111","1111001111","1111001111","0111111111","0111111110","0011111100"];
    numbmp[7]=["11111111","11111111","11111111","00001111","00001111","00001111","00001110","00001110","00011110","00011110","00011110","00011100","00111100","00111100","00111100","00111100","00111000","01111000","01111000"];
    numbmp[8]=["0011111100","0111111110","1111111111","1111001111","1111001111","1111001111","1111001111","0111111110","0011111100","0111111110","1111001111","1111001111","1111001111","1111001111","1111001111","1111001111","1111111111","0111111110","0011111100"];
    numbmp[9]=["0011111100","0111111110","1111111111","1111001111","1111001111","1111001111","1111001111","1111001111","1111001111","1111001111","1111111111","0111111111","0011101111","0000001111","1111001111","1111001111","1111111110","0111111110","0011111000"];
    
    numbmp['A']=["0001000000000000000000000","0011000000111100000000000","0000000001111110000000000","0000000001111111000000000","0000000001110111000000000","0000000001110111000000000","0000001011100011100100000","0000001011100011100000000","0000000111000001110000000","0000001110000110111000000","0000101110001000111000000","0000011100000010011000000","0000011100001100011101000","0000011111111111111110000","0001011111111111111100001","0000111111111111111110000","0011111000000000001110000","0001111000000000001110000","0001110000000000000111000","0011110000000000000111000","0001111000000000000111000","0111100000000000000011100","0011100000000000000011100","0000000000000000000000000","0000000000000000000000000"];
    numbmp['B']=["0000000000000000000000000","0001111111111000000000000","0001111111111111100000000","0001111111111111110000000","0001111000000001111000000","0001111000000000011110000","0001111000000100011100000","0101111000000000011100000","0001111000000000011100000","0001111000000000111000000","0001111111111111100000000","0001111111111111000000000","0001111111111111110000000","0001111000000000111000000","0001111000000000011110000","0001111000000000001110000","1001111000000000001111000","0001111000000000011110000","0001111010000000001110000","0001111000000000001110000","0001111000000000011100000","0001111111111111111000000","0001111111111111100000000","0001111111110000000000000","0000000000110000000000000"];
    numbmp['C']=["0000000001000001010010000","0100000010111111111100000","0001100011111111111110000","0001000111100000000110000","1000001110000001010010000","0000001110000000000000000","0001011100000000011000000","0001011100010000000010000","0000111000000000000000000","0000111000000000000000000","0000111000000000000000000","0000111000000000000000000","0000111000000000000000000","0000111000000000000000000","0000111000000000000000000","0000111000000000000000000","0000011100000000000000000","0000011100000000000000000","0000001110000000000000000","0000001110000000010000000","0000000111100000000110000","0000000011111111111110000","0000000000111111111100000","0000000000000010000000000","0000000100000000000000000"];
    numbmp['D']=["0000000000000000000000000","0001111111000000000000000","0001111111111110000010000","0101111111111111100000100","0001111000010011110000000","0001111000000000111000000","0001111000001000111100000","0001111000000000001110000","0001111000000000011110000","0001111000000000001111000","0001111000000000001110000","0001111000000000001110000","0001111000000000001111000","0001111000000000001110000","0001111000000000001110000","0001111000000000001110000","0001111100000000001100000","0001111100000000011100000","0001111000000000011100000","0001111000000000111000000","0001111000000011110000000","0001111111111111100000000","0001111111111110000000000","0001111110000000000000000","0000000000000000000000000"];
    numbmp['E']=["0000000000000000000000000","0000111111111111111111000","0000111111111111111111000","0000111111111111111111000","0000111110000000000000000","0000111100000000000000000","0000111100000000000000000","1000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111111111111111110000","0000111111111111111110000","0000111111111111111110000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","1000111100000000000000000","0000111111111111111111000","0000111111111111111111000","0000111111111111111111000","0000000000000000000000000"];
    numbmp['F']=["0000000000000000001000000","0001111111111111111100000","0001111111111111111100000","0001111111111111111100000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111111111111111000000","0001111111111111111011010","0001111111111111111000000","0011111000010000000000100","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0000000000010000000000000","0000000000000000000000000"];
    numbmp['G']=["0000000000000000100000000","0000000001111111111000000","0000000011111111111110000","0000001111000000001110000","0000001100000000000000000","0001011100000000000000000","0000111100000000000000000","0000111000000000000000000","0001110000000000000000000","0001110100000000000000000","0001110010000000000000000","0011110101000000000011000","0011110000010111111111000","0001110000000011111111000","0001110000000000101111000","0001110000000000001111000","0011110000000000001111000","0000111000000000011111000","0000111000000000001111000","0000011100010000101111000","0000001111000000001111000","0000000011111111111110000","0000000001111111111000000","0000000000000010000000000","0000000000000000000000000"];
    numbmp['H']=["0000000000000000000000000","0001111000000000001111000","1001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000011111000","0001111111111111111111000","0001111111111111111111000","0001111111111111111111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0001111000000000001111000","0000000000000000000000000"];
    numbmp['I']=["0000010000010000000000001","0000111111111111111100010","0000111111111111111100000","0000111111111111111100000","0000000000111100000000011","0000000000111100000000000","0000000000111100000010100","0000000000111100000010100","0000000000111100000000000","0000000000111100000000000","0000100000111100000000000","0000000000111100000000000","0000000010111100000000000","0000000000111100000000000","0000000000111100000000000","0000000001111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000111111111111111101000","0000111111111111111100000","0100111111111111111100000","0000000000011100000000000"];
    numbmp['J']=["0000000000000000000000000","0000000011111111111000000","0000010011111111111000010","0010010011111111111000000","0100100000000001111000000","0000000000000011111000000","0000000100000001111000000","0001000000000001111000000","0000000000000001111000000","0000000000000001111000000","0000000000000001111000000","0000000000000001111000000","0000000000000001111000000","0000000000000001111000000","0000000000000001110000000","0000000000000001110000000","0000000000000001110000000","0001000000000001110000000","0011000000000001110000000","0011000000000101100000000","0011101000100011100000000","0011111111111111000000000","0000011111111111000000000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['K']=["0000000000000000000000000","0011110000000000111000000","0111100000000011111001000","0111100000010111000000000","0111100000001110000000000","0111100001011100000000000","0011110000011100000000000","0011110000111010000000000","0011110001110000000000000","0011110011100100000000000","0011110111100000000000000","0011111111110000000000000","0011111101111000000000000","0011111000111000000000000","0011110000011100000000000","0011110000011110000000000","0011110000001111000000000","0011110000001111000000000","0011110000000111100000000","0011110000000111100000000","0011110000000111110000000","0011110000000001111000000","0011110000000000111100000","0011110000000000011100000","0000000000000000000000000"];
    numbmp['L']=["0000000000000000000000000","0000111100000000000000000","0000111100000000010000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","1000111101000000000000000","0000111100000000000000000","1000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000000000","0000111100000000000001010","0000111100000000000000100","1000111111111111111111000","0000111111111111111111000","0000111111111111111111000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['M']=["0000000000000000000000000","0011111100000000111111100","0011110100000000010111100","0011111100000001010111100","0011110010000000100111100","0011110010000000100111100","0011110011000001100111101","0011110001100001000111100","0011110001100011000111100","0011110000100011000111100","0011110001100010010111100","0011110001110110100111100","0011110001011110100111100","0011110000011100000111100","0011110000011100000111100","0011110000000000000111100","0011110000000000000111100","0011110000000000000111100","0011110000000000000111100","0011110000000000000111100","0011110000000000000111100","0011110000000000000111100","0011110000000000000111100","0000000000000000000000000","0000000000000000000000000"];
    numbmp['N']=["0000000000000000000000000","0001111100000000001111000","0001111100000000001111000","0001111111000000001111000","0001111110000000001111000","0001111111000000001111000","0001111011000000001111000","0001111001110000001111000","0001111001100000001111000","0001111000110000001111000","0001111000011000001111000","0001111000001100001111000","0001111000000110001111000","0001111110000011101111000","1001111000000011001111000","0001111000000011011111000","0001111000000001101111000","0001111000000001101111000","0001111000000000111111000","0001111000000000111111000","0001111000000000111111000","0001111000000000111111000","0001111000000000011111000","0000000000000010000000000","0000000000000000000000000"];
    numbmp['O']=["0000000000000000000000000","0000000011111111000000000","0000011111111111110000000","0000011100000100111000000","0000011000000000111000000","1010111000000000011100000","0000110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000011110000","1001110000000000001110010","1001110000000000101111010","0001110000100000001111000","0001110000000001001110010","0000110000000000011100000","0000111000000000011100000","0000111000100000011000000","0000011100000000111001000","0000001111111111110000000","0000000011111111100000000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['P']=["0000000000000000000000000","0001111111111111100000000","0001111111111111111000000","0001111000000000111100000","0001111000001000011111000","0001111000000000001111001","0001111000000000001110000","0001111000000000001110001","0001111000000000001110000","0001111000000000001110000","0001111000000000001110000","0001111000000000011110000","0001111000000000111100000","0001111111111111100000000","0001111111111000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0001111000000000000000000","0000000000000000000000000"];
    numbmp['Q']=["0000000000000000000000000","0000000011111111000000000","0000011111111111110000000","0000011100000100111000000","0000011000000000111000000","1010111000000000011100000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","1001110000000000001110010","0001110000100000001111000","0000110000000000011100000","0000111000100000011000000","0000011100000000111001000","0000001111111111110000000","0000000011111111100000000","0000000000101111000000000","0000000000000011100000000","0000000000000001110000000","0000000000000000111000000","0000000000000000011100000","0000000000000000001110000","0000000000000000000000000"];
    numbmp['R']=["0000000000001000100000000","0001111111110101000010000","0001111111111111000010000","0001111111111111110000000","0001111000000001111100000","0001111000000000111110100","0001111000000000111100000","0001111010000000011100000","0001111000000000011100000","0001111000000000011100000","0001111000000010111000000","0001111001100000111000000","1001111111111111101000001","0001111111111111000000010","0001111000000011100000010","0001111000000001110000001","0001111100000001111000000","0001111010100000111000000","0001111000000000011100100","0001111100000000001110000","0001111000100000000111000","0001111000000000000011100","0001111000000000000011100","0000000000000000000000000","0000000000000000000000000"];
    numbmp['S']=["0000000000000000000000000","0000001011111111100000000","0000001111111111111100000","0000011110000000011100000","0010011100000000000000000","0010111000000000000000000","0000111000000000000000000","0000111000000000000000000","0000111000000000000000010","0000111100000000000000000","0000011111000000000000000","0000001111111100000000000","0000000000111111111000000","0000000000000011111100000","0000000000000000111100000","0000000000000000001110000","0000000000000000001110000","1000000000000000001110000","0000000000000000001110000","0001000000000000011110000","0001110000000000111100000","0001111111111111111000000","0001001111111111100000000","0000000000010001000000000","0000000000000000000000000"];
    numbmp['T']=["0000000000000000000000000","0111111111111111111111100","0111111111111111111111100","0111111111111111111111100","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000000000000000000"];
    numbmp['U']=["0000000000000000000000000","0001111000000000111110000","0001111000000000011110000","0001111000010000011110000","0001111000000000011110000","0001111000000000011110000","0001111000000001011110000","0001111000000100011110000","0001111000001000011110000","0001111000000000011111000","0001111000000000011111000","0001111000000000011110000","0001111000000000011110000","0001111000000000011110000","0001111000000000011110000","0000111000000000011100000","0000111000000000011100000","0000111000000000011100000","0000111000000000011100000","0000111100000000011100000","0000011100000000111000000","0000001111111111110000000","0000000011111111000000000","0000000000100000000000000","0000000000000000000000000"];
    numbmp['V']=["0000000000000000000000000","0011100000000000000111000","0011100000000000001111000","0011100000000000000111000","0001110000000000001110000","0001110000000000001110000","0001110000000000001111000","1000111000000000011100000","0000111000000000011100000","0000011100000000111000000","0000011100000000111000000","0000001110000001110000000","0000001110000001110000000","0000001110000001110000000","0000001110000001110000000","0000000111000011100000000","0000000011100111000000000","0000000011100111000000000","0000000001111110000000000","0000000001111110000000000","1000000001111110000000000","0000000000111100000000000","0000000000111100000000000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['W']=["0000000000000000000000000","0111000000000000000011100","0111000000000000000111100","0111000001000000000111100","0111000000000000000011100","0111000000000000000111100","0111000000000000000011100","0011110000111100000111000","0011100000101110001111000","0011100010100100000111000","0001110001100110001110000","0001110001100110101110000","0001110001100110001110000","0001110001001011001110000","0001110011000011101110000","0001110011000011011110000","0001110011000011001110000","0000111010000001011100000","0000111110000001111100000","0000111110000001111100000","0000111100000000111100000","0000011100000000111100000","0000011100000000111000000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['X']=["0100000000000000000000000","1001110000000000000111000","0110111000000000001110000","0000111100001000011111000","0000001110000000111000100","0000000111000001110000000","0000000111100011110000000","0010001011100011100000000","0000000011110111100000000","0000000001111111000100000","0000000000111110000000000","0000000000111100000000000","0000000000011100000000000","0000000001111111000000000","0000000111101011100000000","0000001111000001111000000","0000001110000000111000000","0000011110000000011110000","0000111100000000011100000","0000111000000000001111000","0001110000000000001111100","0101110000000000000111000","0011100000000000010111000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['Y']=["1100000000000000000000000","0001111000000000001110000","0000111000000000011100000","0000111000000000011100000","0000011100000000111000000","0000011110000001111000000","0000001110000001111000000","0000001111000011110000000","0000000111000011100000000","0000000011100111000000000","0000000011100111000001000","0000000001111110000000000","0000000001111110000000000","1000000010111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000111100000000000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['Z']=["0000000000000000000000000","0001111111111111111111100","0001111111111111111111100","0001111111111111111111100","0000000100100000000111000","0000000000000000001111000","0000101010010000111100000","0000000010000001111000000","0000000000000001110000100","0000000000000011100000000","0000100000000111101000000","0000000000011110000000000","0000000000011100000000000","0010010001111000000000000","0000000001110000000000010","0000000111100000000000001","0000000111000000001100000","0001011110000010100000000","0000011100000000000000000","0000111000000100000000000","0001111111111111111111100","0001111111111111111111100","0001111111111111111111100","0000000000000000000000000","0000000000000000000000000"];
    return numbmp;
}

function loadNumMask1() {
    var numbmp=[];
    numbmp[0] = ["000000001111000","000000111111110","000001110000110","000011000000011","000110000000011","001100000000011","011100000000011","011000000000011","111000000000110","110000000000110","110000000001110","110000000001100","110000000011000","110000000111000","011000011110000","011111111000000","000111110000000"];
    numbmp[1] = ["00000111","00001111","00011110","00010110","00001100","00001100","00011000","00011000","00110000","00110000","00110000","01100000","01100000","01100000","11000000","11000000","11000000"];
    numbmp[2] = ["00000011111000","00001111111110","00011100000110","00011000000011","00000000000011","00000000000011","00000000000011","00000000000110","00000000001110","00000000011100","00000001110000","00000111100000","00001110000000","00111100000000","01110000000000","11111111110000","11111111111110","00000000011110"];
    numbmp[3] = ["000000111111000","000011111111110","000111100000111","000110000000011","000000000000011","000000000000011","000000000001110","000000111111000","000000111111000","000000000011100","000000000001100","000000000001100","110000000001100","111000000011100","111100000111000","001111111110000","000111111000000"];
    numbmp[4] = ["00000011000001","00000110000011","00001100000010","00011000000110","00111000000110","00110000001100","01100000001100","01100000001000","11000000011000","11111111111111","11111111111111","00000000110000","00000000110000","00000000100000","00000001100000","00000001100000","00000001100000"];
    numbmp[5] = ["0000001111111111","0000011111111111","0000111000000000","0000110000000000","0000110000000000","0001110000000000","0001101111100000","0001111111111000","0001110000011000","0000000000001100","0000000000001100","0000000000001100","1100000000001100","1110000000011000","1111000001111000","0111111111100000","0001111110000000"];
    numbmp[6] = ["000000001111100","000000111111110","000011110000111","000111000000011","000110000000000","001100000000000","011001111100000","011111111111000","111110000011000","111000000001100","110000000001100","110000000001100","110000000001100","111000000011000","011100001110000","001111111100000","000111110000000"];
    numbmp[7] = ["1111111111111","1111111111111","0000000001110","0000000011100","0000000111000","0000000110000","0000001100000","0000011100000","0000111000000","0000110000000","0001100000000","0011100000000","0011000000000","0111000000000","1110000000000","1100000000000","1100000000000"];
    numbmp[8] = ["0000000111110000","0000011111111100","0000011000001110","0000110000000111","0000110000011111","0000110001111000","0000011111100000","0000011110000000","0001111111000000","0011100011100000","0111000001110000","1110000000110000","1100000000110000","1100000001110000","1110000011100000","0111111111000000","0001111100000000"];
    numbmp[9] = ["0000011111000","0001111111110","0011100000110","0011000000011","0110000000011","0110000000011","0110000000011","0110000000111","0011000011110","0011111111110","0000111100110","0000000001100","0000000011000","0000000111000","0000011110000","1111111000000","1111110000000"];
    
    numbmp['A']=["000100000000000000000000000001","001100000011110000000000000000","000000000111111000000000000000","000000000011111000000000000000","011000000011111000000000000000","000000000111111100000000000000","000000000111011100000000000000","000000000111011100000000000000","000000001110001110000000000000","000000101110001110010000000000","000000101110001110000000000000","000000011100000111000000000000","000000011100000111000000000000","000000011100000111100000000000","000000111000000011100000000000","000000111000011011100000000000","000010111000100011100000000000","000001110000001001100000000000","000001110000110001110100000000","000001111111111111111000000000","000101111111111111110000100000","000011111111111111111000000000","001111100000000000111000000000","000111100000000000111000000000","000111000000000000011100000000","001111000000000000011100000000","000111100000000000011100000001","001110000000000000011110000001","011110000000000000001110000000","001110000000000000001110000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['B']=["000000000000000000000000000000","000111111111100000000000000000","000111111111111110000000000000","000111111111111111000000000000","000111100000000111100000000000","000111100000000001111000000000","000111100000000001110000000000","000111100000000001110000000001","000111100000000001110000000000","000111100000010001110000000000","010111100000000001110000000000","000111100000000001110000000000","000111100000000011100000000000","000111111111111110000000000000","000111111111111100000000000000","000111111111111111000000000000","000111100000000011100000000000","000111100000000001111000000000","000111100000000000111000000000","000111100000000000111000000000","000111100000000000111000000000","101111100000000001111000000000","100111100000000000111100000000","000111100000000001111000000000","000111101000000000111000000000","000111100000000000111000000000","000111100000000001110000000000","000111111111111111100000000000","000111111111111110000000000000","000111111111000000000000000000","000000000011000000000000000000","000000000000000000000000000001",];
    numbmp['C']=["000000000100000101001000000010","010000001011111111110000010100","000110001111111111111000000001","000100011110000000011000000000","100000111000000101001000000000","000000111000000000000000000000","000101110000000001100000000000","000101110001000000001000000010","000111100000000000100000000000","000011100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000111100000000000000000000000","000111100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000011100000000000000000000000","000001110000000000000000000000","000001110000000000000000000000","000000111000000000000000000000","000000111000000001000000000000","000000011110000000011000000000","000000001111111111111000000000","000000000011111111110000000000","000000000000001000000000000000","000000010000000000000000000000","000000000000000000000000000000",];
    numbmp['D']=["000000000000000000000000000000","000111111100000000000000000000","000111111111111000001000000000","010111111111111110000010000000","000111100001001111000000000000","000111100000000011100000000000","000111100000100011110000000000","001111110000000001110000000000","000111100000000000110010000000","101111100000000000111100000000","000111100000000000111000000000","000111100000000001111000000000","000111100000000000111100000000","000111100000000000111000000000","000111100000000000111000000000","000111100000000000111100000000","000111100000000000111000000000","000111100000000000111000000000","000111100000000000111000000000","000111100000000000111000000000","000111100000000000111000000000","000111100000000000111000000000","000111110000000000110000000000","000111110000000001110000000000","000111100000000001110000000000","000111100000000011100000000000","000111100000001111000000000000","000111111111111110000000000000","000111111111111000000000000000","000111111000000000000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['E']=["000000000000000000000000000100","000011111111111111111100000000","000011111111111111111100001000","000011111111111111111100001000","000011111000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","100011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011111111111111111000000000","000011111111111111111000000000","000011111111111111111000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","100011110000000000000000000000","000011111111111111111100000000","000011111111111111111100000000","000011111111111111111100000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['F']=["000000000000000000010000000000","000011111111111111111000000000","000011111111111111111000000000","000011111111111111111000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011111111111111110000000000","000011111111111111110110100000","000011111111111111110000000000","000111110000100000000001000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000000000000100000000000000000","000000000000000000000000000000",];
    numbmp['G']=["000000000000000010000000000000","000000000111111111100000000000","000000001111111111111000000000","000000111100000000111000000000","000000110000000000000000000000","000101110000000000000000000000","000011110000000000000000000000","000011100000000000000000000000","000111000000000000000000000000","000111001000000000000000000000","000111000010000000000000000000","000111000000000000000000000000","000111010000000000000000000000","000111001000000000000000000000","001111010100000000001100000000","001111000001011111111100000000","000111000000001111111100000000","000111000000001111111100000000","000111000000000010111100000000","000111000000000000111100000000","001111000000000000111100000000","000111000000000000111100000000","000011100000000000111100000000","000011100000000001111100000000","000011100000000000111100000001","000001110001000010111100000000","000000111100000000111100000000","000000001111111111111000000000","000000000111111111100000000100","000000000000001000000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['H']=["000000000000000000000000000000","000111100000000000111100000000","100111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","100111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000001111100000000","000111111111111111111100000000","000111111111111111111100000000","000111111111111111111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000111100000000000111100000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['I']=["000001000001000000000000100000","000011111111111111110001000100","000011111111111111110000000101","000011111111111111110000000000","000000000011110000000001110000","000000000011110000000000000000","000000000011110000001010000000","000000000011110000001010001001","000000000011110000000000001000","000000000011110000000000000000","000010000011110000000000000000","000000000011110000000000000000","000010000011110000000000000000","000010000011110000000000000000","000010000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000001011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000111110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000011111111111111110100000000","000011111111111111110000000000","010011111111111111110000000000","000000000001110000000000000000","000000000000000000000000000000",];
    numbmp['J']=["000000000000000000000000000000","000000001111111111100000000000","000001001111111111100001000000","001001001111111111100000000000","010010000000000111100000000000","000000000000001111100000000001","000000000000011111100000000000","000011101000000111100000000000","000010000000000111100000000000","000000010000000111100000000000","000100000000000111100000000001","000000000000000111100000000000","000000000000000111100000000000","000000000000000111100000000000","000000000000000111100000000000","000000000000000111100000000000","000000000000000111100000000001","000000001100000111100000000000","100010000000000111100000000000","000000001100000111100000000000","000000000000000111000000000001","000000000000000111000000000000","000000000000000111000000000000","000100000000000111000000000000","001100000000000111000000000000","001100000000010110000000000000","001110100010001110000000000001","001111111111111100000000000000","000001111111111100000000000001","000000000000000000000000000001","000000000000000000000000000000","000000000000000000000000000001",];
    numbmp['K']=["000000000000000000000000000000","000111100000000000001110000000","100111100000000001011100000000","000111100000000000111000000000","100111100000000001110000000000","00111100000000011111001000000","00111100000010111000000000000","00111100000001110000000000000","00111100001011100000000000000","000111100000111000000000000000","000111100001110100000000000000","000111100011100000000000000000","000111100111001000000000000000","000111101111000000000000000000","000111111111100000000000000000","000111111011110000000000000000","000111110001110000000000000000","000111100000111000000000000000","000111100000111100000000000000","000111100000011110000000000000","000111100000011110000000000000","000111100000001111000000000000","000111100000001111000000000000","000111100000001111100000000000","000111100000000011110000000000","000111100000000001111000000000","100111100000000000111000000000","000111100000000000111100000000","000111100000000000011110000000","000111100000000000001110000000","100000000000000000000000000000","000000000000000000000000000000",];
    numbmp['L']=["000000000000000000000000000000","000011110000000000000000000000","000011110000000001000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","100011110100000000000000000000","000011110000000000000000000000","100011110000000000000000000000","000011110000000000000000000010","000011110000000000000000000001","000011110000000000000000000000","000011110000000000000101000000","000011110000000000000010000000","100011111111111111111100000000","000011111111111111111100000000","000011111111111111111100000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['M']=["000000000000000000000000000000","001111100000000000111110000000","001111100000000000111110000000","001111110000000011111110000000","001111010000000001011110000000","001111110000000101011110000000","001111011000000011011110010000","001111001000000010011110000000","001111001000000010011110000001","001111001100000110011110100000","001111000100000100011110000000","001111000110000100011110000001","001111000110001100011110000000","001111000010001100011110000000","001111000110001001011110000000","001111000111011010011110000000","001111000101111010011110000000","001111000011111000011110000000","001111000001110000011110000000","001111000001110000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","001111000000000000011110000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['N']=["000000000000000000000000000000","000111110000000000111100000000","000111110000000000111100000000","000111111100000000111100000000","000111111000000000111100000000","000111111100000000111100000000","000111101100000000111100000000","000111101100000000111100000000","000111100111000000111100000000","000111100110000000111100000000","000111100110000000111100000000","000111100111100000111100000000","000111100011000000111100000000","000111100001100000111100000000","000111100001100000111100000100","000111100001110000111100000010","000111100000110000111100000010","000111100000110000111100000000","000111100000011000111100000000","000111100010011000111100000000","000111111000001110111100000000","100111100000001100111100000000","000111100000001101111100000000","000111100000000110111100000000","000111100000000110111100000000","000111100000000011111100000000","000111100000000011111100000000","000111100000000011111100000000","000111100000000011111100000000","000111100000000001111100000000","000000000000001000000000000000","000000000000000000000000000000",];
    numbmp['O']=["0000000000000000000000000","0000000011111111000000000","0000011111111111110000000","0000011100000100111000000","0000011000000000111000000","1010111000000000011100000","0000110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000001110000","0001110000000000011110000","1001110000000000001110010","1001110000000000101111010","0001110000100000001111000","0001110000000001001110010","0000110000000000011100000","0000111000000000011100000","0000111000100000011000000","0000011100000000111001000","0000001111111111110000000","0000000011111111100000000","0000000000000000000000000","0000000000000000000000000"];
    numbmp['P']=["000000000000000000000000000000","000011111111100000000000000000","000011111111111111000000000000","000011111111111111110000000000","000011110000000001111000000000","000011110000010000111110000000","000011110000000000011110011000","000011110000000000011100000000","000011110000000000011100010000","000011110000000000011100000000","000011110000000000011100000000","000011110000000000011100000000","000011110000000000011100000000","000011110000000000111100000000","000011110000000001111000000000","000011111111111111110000000000","000011111111111111000000000000","000011111111110000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000011110011000000000000000000","000011110011000000000000000000","000011110000000000000000000000","000011110000000000000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['Q']=["000000000000000000000000000000","000000001111111100000000000000","000001111111111111000000000000","000001110000010011100000000000","000001100000000011100000000000","101011100000000001110000000000","000011000000000000111000000000","000111000000000000111000000000","000111000000000000111000000000","000111000000000000111000000000","000111000000000000111000000000","000111000000000000111000000000","000111000000000000111000000000","000111000000000000111000000000","001111000000000000111000000000","001111000000000000111000000000","000111000000000000111000000000","000111000000000000111000000000","000111000000000001111000000000","100111000000000000111001000000","100111000000000010111101000000","000111000010000000111100000000","000111000000000100111001000000","000011000000000001110000000000","000011100000000001110000000000","000011100010000001100000000010","000001110000000011100100000000","000000111111111111000000000000","000000001111111110000000000000","000000000010111100000000000000","000000000000001110000000000000","000000000000000111000000000000",];
    numbmp['R']=["000000000000100010000000000000","000111111111010100001000010110","000111111111111100001000000000","000111111111111111000000000000","000111100000000111110000000000","000111100000000011110000000000","000111100000000011111010000000","000111100000000011110000000010","000111101000000101110000000010","000111101000000001110000000000","000111100000000001110000000000","000111101000000001111000000000","000111100000000001110000000100","000111100000001011100000000000","000111100110000011100000000000","100111111111111110100000100000","000111111111111000000000000000","000111111111111100000001000000","000111100000001110000001000000","000111100000000111000000100000","000111110000000111100000000000","000111101010000011100000001000","000111100000000001110010010100","000111101011000001110000000000","000111110000000000111000000000","000111100010000001111000000000","000111100010000000011100000000","000111100000000000011100001000","000111100000000000001110000000","000111100000000000001110000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['S']=["000000000000000000000000000000","000000101111111110000000000000","000000111111111111110000000000","000001111000000001110000000000","001001110000000000000000000000","001011100000000000000000000000","000011100000000000000000000000","010111110000000000000000000000","100011100100000000000000000000","000011100000000000000000000000","000011100000000000000001010000","000011110000000000000000000000","000001111100000000000000000000","000000111111110000000000000000","000000011111111110000000000000","000000000011111111100000000100","000000000000001111110000001000","000000000000000011110000000000","000000000000000000111110000000","000000000000000000111100000000","000000000000000000111000000000","000000000000000001111000000000","000000000000000000111000000000","100000000000000000111000000000","000000000000000000111000000000","000100000000000001111000000000","000111000000000011110000000000","000111111111111111100000000000","000100111111111110000000000000","000000000001000100000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['T']=["000000000000000000000000000000","011111111111111111111110000000","011111111111111111111110000000","011111111111111111111110000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000111110000000000000000","000000000111110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000111110000000000000000","000000001111110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011111000000000000000","000000000011111000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['U']=["000000000000000000000000000000","000111100000000011111000000000","000111100000000001111000000000","000111100001000001111000000000","000111100000000001111000000000","000111100000000001111000000000","000111100000000101111000000000","000111100000010001111000000000","000111100000100001111000000000","000111100000100001111010000000","000111100000000001111000000000","000111100000000001111000000001","000111100000100001111000000000","000111100000000001111100000000","000111100000000001111100000000","000111100000000001111000000000","000111100000000001111000000000","000111100000000001111000000000","000111100000000001111000000000","000011100000000001110000000000","000011100000000011110000000000","000011100000000011110000000000","000011100000000001110000000000","000011100000000001110000000000","000011100000000001110000000000","000011110000000001110000000000","000001110000000011100000000000","000000111111111111000000000000","000000001111111100000000000000","000000000010000000000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['V']=["000000000000000000000000000000","001110000000000000011100000000","001110000000000000111100000000","001110000000000000011100000000","000111000000000000111000000100","000111000000000000111000000000","000111000000000000111100000000","100011100000000001110000000000","000011100000000001110000000000","000011100000000001110000000000","000011100000000001110000000000","000001110000000011100000000000","000001110000000011100000000000","000001110000001011100000000000","000000111000000111000000000000","000000111000000111000000000000","000000111000000111000000000000","000000111000000111000000000000","100000011110001110000000000000","000000011100011111100000000000","000000011100001110000000000000","000000001110011100000000000000","000000001110011100000000000000","000000001110011100000000000000","000000000111111000000000000000","000000000111111000000000000000","000000000111111000000000000000","100000000111111000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['W']=["000000000000000000000000000000","011100000000000000001110000000","011100000000000000011110000000","011100000100000000011110000000","011100000000000000001110000000","011100000000000000011110000000","011100000000000000001110000000","011100000000000000011100000000","001111100000000000011100000000","001110000011110000011100000000","001110000011110000011100000000","001111000011110000011100000000","001110000010111000111100000000","001110001010010000011100000000","000111000110011000111000000000","000111000110011010111000000000","000111000110011000111000000000","000111000100101100111000000000","000111001100001110111000000000","000111001100001101111000000000","000111001100001100111000000000","000011101000000101110000000000","000011111000000111110000000000","000011111000000111110000000000","000111111000000111110000000000","000011111000000111110000000000","000011110000000011110000000000","000001110000000011110000000000","000001110000000011100000000000","000001110000000011100000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['X']=["010000000000000000000000000000","100111000000000000011100000000","011011100000000000111000000000","000011110000100001111100000011","100001111000001111110000001000","000001111010000111110000000000","000000111000000011100010000000","000000011100000111000000000010","000000011110001111000000000001","001000101110001110000000000010","000000001111011110000000000000","000000000111111100010000000000","000000000011111000000000001000","000000000011110000000000000000","000000000001110000000000000000","000000000011111000000000000000","000000000011111000000000001000","000000000111111110000000000000","000000000111111100000000000000","000000011110011110000000000000","000000011110101110000000000000","000000011100101111000000000000","000000111100000111100000000000","000000111000000011100000000000","000001111000000001111000000000","000011110000000001110000000000","000011100000000000111100000000","000111000000000000111110000000","010111000000000000011100000000","001110000000000001011100000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['Y']=["110000000000000000000000000000","001111000000000000011110000000","001111000000000001111000000000","001111110000001000111000000000","000011100000001101110000000000","000011100000000001110000000000","000001110000000011100000000000","000001111000000111100000000000","000000111000000111100000000000","000000111100001111000000000000","000000011100001110000000000000","000000001110011100000000000000","000000001110011100000100000000","000000000111111000000000000000","000000000111111000000000000000","100000001011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000111110100000000010000","000000010011110010001000000000","000000000111110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","000000000011110000000000000000","010000000011110000000000000000","000000000000000000000000000000","000000000000000000000000000000",];
    numbmp['Z']=["000000000000000000000000000000","000111111111111111111110000010","000111111111111111111110000000","000111111111111111111110000000","000000010010000000011100000000","000000000000000000111100000000","000000000000000011111000000000","000000000100000001110001000000","000010101001000011110000000000","000000001000000111100000010000","000000000000000111000010000000","000000000000001110000000000000","000010000000011110100000000000","000100000110011110000000000000","000000000000111000000000000000","000000000001111000000000000000","000000000001110000000000000000","000000001111100000000000000000","001001000111100000000000001010","000000000111000000000001000000","100000001111001000000000000000","000000011110000000000000100000","000000011100000000110000001010","000000111000000100100000001000","000101111000001010000000000000","000001110000000000000000000000","000011100000010000000000000000","000111111111111111111110000000","000111111111111111111110000000","000111111111111111111110000000","000000000000000000000000000000","000000000000000000000000000000",];
    return numbmp;
}


function captchapng(width,height,dispNumber) {
    this.width   = width;
    this.height  = height;
    this.depth   = 8;
    this.dispNumber = ""+dispNumber.toString();
    this.widthAverage = parseInt(this.width/this.dispNumber.length);

    var p = new pnglib(this.width,this.height,this.depth);

    for (var numSection=0;numSection<this.dispNumber.length;numSection++){

        var dispNum = this.dispNumber[numSection].valueOf();

        var font = parseInt(Math.random()*myself.numMask.length);
        font = (font>=myself.numMask.length?0:font);
        //var random_x_offs = 0, random_y_offs = 0;
        var random_x_offs = parseInt(Math.random()*(this.widthAverage - myself.numMask[font][dispNum][0].length));
        var random_y_offs = parseInt(Math.random()*(this.height - myself.numMask[font][dispNum].length));
        random_x_offs = (random_x_offs<0?0:random_x_offs);
        random_y_offs = (random_y_offs<0?0:random_y_offs);

        for (var i=0;(i<myself.numMask[font][dispNum].length) && ((i+random_y_offs)<this.height);i++){
            var lineIndex = p.index(this.widthAverage * numSection + random_x_offs,i+random_y_offs);
            for (var j=0;j<myself.numMask[font][dispNum][i].length;j++){
                if ((myself.numMask[font][dispNum][i][j]=='1') && (this.widthAverage * numSection + random_x_offs+j)<this.width){
                    p.buffer[lineIndex+j]='\x01';
                }
            }
        }
    }
    return p;
}

module.exports = captchapng;
